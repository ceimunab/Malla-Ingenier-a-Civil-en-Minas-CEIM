<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Malla Curricular CEIM 2025</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #fff;
      margin: 0;
      padding: 0;
    }
    header {
      display: flex;
      align-items: center;
      background-color: #fff5e1;
      padding: 10px 20px;
      border-bottom: 2px solid #d8a35d;
    }
    header img {
      height: 80px;
      margin-right: 20px;
    }
    header h1 {
      font-size: 24px;
    }
    .container {
      padding: 20px;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(10, 1fr);
      gap: 8px;
      text-align: center;
    }
    .semester-title {
      font-weight: bold;
      background-color: #f2d6b3;
      padding: 6px;
    }
    .course {
      background-color: #fff9ee;
      border: 1px solid #d8a35d;
      padding: 8px;
      border-radius: 6px;
      min-height: 50px;
      cursor: pointer;
      position: relative;
      font-size: 13px;
    }
    .course.locked {
      background-color: #eee;
      color: #aaa;
      cursor: not-allowed;
    }
    .course.completed {
      background-color: #d8f5d0;
      border-color: #5cb85c;
    }
    .tooltip {
      visibility: hidden;
      width: 200px;
      background-color: #333;
      color: #fff;
      text-align: center;
      border-radius: 6px;
      padding: 5px;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.3s;
    }
    .course:hover .tooltip {
      visibility: visible;
      opacity: 1;
    }
    .acciones {
      margin-bottom: 15px;
    }
    #progreso {
      margin-bottom: 10px;
      font-weight: bold;
      color: #9d6b1f;
    }
  </style>
</head>
<body>
  <header>
    <img src="https://drive.google.com/uc?export=view&id=1zmdkjB_XNz5FhoAXCz8vBeoSpq8Vpbbl" alt="Logo CEIM">
    <h1>Centro de Estudiantes de Ingeniería Civil en Minas</h1>
  </header>
  <div class="container">
    <div id="progreso"></div>
    <div class="acciones">
      <button onclick="exportarProgreso()">Exportar progreso</button>
      <button onclick="window.print()">Generar PDF</button>
      <button onclick="marcarTodo()">Marcar todo</button>
      <button onclick="resetearProgreso()">Resetear progreso</button>
    </div>
    <div class="grid" id="malla"></div>
  </div>
  <script>
    const cursos = {
      "1": ["Introducción a las Matemáticas", "Física General", "Introducción a la Ingeniería", "Introducción a la Programación", "Habilidades Comunicativas"],
      "2": ["Cálculo Diferencial", "Física Experimental", "Base de Datos", "Geología I", "Comunicación Oral y Escrita"],
      "3": ["Cálculo Integral", "Álgebra Lineal", "Mecánica Clásica", "Química General", "Geología II"],
      "4": ["Ecuaciones Diferenciales", "Termodinámica", "Mecánica de Fluidos", "Mineralogía", "Métodos Numéricos"],
      "5": ["Mecánica de Rocas I", "Metalurgia Extractiva", "Topografía y Geomática", "Minería Subterránea", "Probabilidades y Estadística"],
      "6": ["Mecánica de Rocas II", "Minería a Cielo Abierto", "Ventilación de Minas", "Geotecnia", "Simulación de Procesos"],
      "7": ["Tronadura y Perforación", "Planificación Minera", "Transporte de Materiales", "Hidrología y Drenaje", "Gestión Ambiental"],
      "8": ["Evaluación de Proyectos Mineros", "Seguridad y Salud Ocupacional", "Automatización y Control", "Economía de Minerales", "Taller de Integración"],
      "9": ["Ética Profesional", "Innovación y Emprendimiento", "Electivo 1", "Electivo 2", "Electivo 3"],
      "10": ["Trabajo de Título"]
    };

    const aprobadas = JSON.parse(localStorage.getItem("aprobadas") || "[]");

    function crearMalla() {
      const contenedor = document.getElementById("malla");
      for (let i = 1; i <= 10; i++) {
        const titulo = document.createElement("div");
        titulo.className = "semester-title";
        titulo.textContent = `Semestre ${i}`;
        contenedor.appendChild(titulo);
        cursos[i].forEach(curso => {
          const div = document.createElement("div");
          div.className = "course";
          div.textContent = curso;
          if (aprobadas.includes(curso)) div.classList.add("completed");
          div.onclick = () => {
            if (aprobadas.includes(curso)) {
              aprobadas.splice(aprobadas.indexOf(curso), 1);
            } else {
              aprobadas.push(curso);
            }
            localStorage.setItem("aprobadas", JSON.stringify(aprobadas));
            location.reload();
          };
          contenedor.appendChild(div);
        });
      }
    }

    function marcarTodo() {
      const todas = [];
      for (let i = 1; i <= 10; i++) cursos[i].forEach(c => todas.push(c));
      localStorage.setItem("aprobadas", JSON.stringify(todas));
      location.reload();
    }

    function resetearProgreso() {
      localStorage.removeItem("aprobadas");
      location.reload();
    }

    function actualizarProgreso() {
      let total = 0;
      let completadas = 0;
      for (let i = 1; i <= 10; i++) {
        cursos[i].forEach(c => {
          total++;
          if (aprobadas.includes(c)) completadas++;
        });
      }
      const porcentaje = Math.round((completadas / total) * 100);
      document.getElementById("progreso").textContent = `Progreso: ${completadas} / ${total} cursos aprobados (${porcentaje}%)`;
    }

    function exportarProgreso() {
      const data = JSON.stringify(aprobadas, null, 2);
      const blob = new Blob([data], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'progreso_ceim.json';
      a.click();
      URL.revokeObjectURL(url);
    }

    crearMalla();
    actualizarProgreso();
  </script>
</body>
</html>

